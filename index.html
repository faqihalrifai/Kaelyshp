<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>kaelyshp - Kurator Skincare Viral & Body Care Premium | Original & BPOM</title>
    <meta name="description" content="Temukan koleksi kurasi terbaik skincare viral (PHERINI, Lavojoy, Grace & Glow) dan body care premium di kaelyshp. Jaminan 100% Original, BPOM, dan aman.">
    <meta name="keywords" content="skincare viral, body care, pemutih ketiak permanen, Lavojoy tone up, PHERINI cream, kaelyshp, toko online original BPOM">
    <meta name="theme-color" content="#DB2777">

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NGT63PHVKB"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-NGT63PHVKB');
    </script>

    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">

    <link rel="icon" href="Favicon.png">
    <link rel="icon" href="https://kaelyshp.online/Favicon.png" sizes="144x144" type="image/png">
    <link rel="apple-touch-icon" href="https://kaelyshp.online/Favicon.png">
    <link rel="shortcut icon" href="https://kaelyshp.online/Favicon.png" type="image/png">
        
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "kaelyshp",
      "url": "https://kaely.online", 
      "logo": "https://kaelyshp.online/Favicon.png",
      "description": "Toko online terkurasi untuk produk skincare dan body care.",
      "contactPoint": {
        "@type": "ContactPoint",
        "email": "kontak@kaely.online", 
        "contactType": "Customer Service"
      }
    }
    </script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
      tailwind.config = {
        extend: {
          fontFamily: {
            sans: ['Inter', 'sans-serif'],
          },
          colors: {
            'pink': {
              50: '#FFF7F9',
              100: '#FDF2F8',
              200: '#FCE7F3',
              300: '#FBCFE8',
              400: '#F9A8D4',
              500: '#F472B6',
              600: '#EC4899',
              700: '#DB2777',
              800: '#BE185D',
              900: '#9D174D',
            }
          }
        }
      }
    </script>
    
    <style>
        /* Font Display Swap */
        @font-face {
            font-family: 'Inter';
            font-style: normal;
            font-weight: 400 800;
            font-display: swap;
            src: url(https://fonts.gstatic.com/s/inter/v13/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfAZ9hjp-Ek-_EeA.woff2) format('woff2');
        }

        /* Critical CSS inline */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FFF7F9; 
            color: #374151;
            line-height: 1.7;
            overflow-x: hidden;
        }
        html { scroll-behavior: smooth; }
        
        a, button, .product-card { transition: all 0.3s ease-in-out; }
        
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.4s ease-out; }
        .accordion-button.active .arrow { transform: rotate(180deg); }
        .arrow { transition: transform 0.3s ease; }

        .product-card {
            background-color: white;
            border: 1px solid #FDF2F8; 
            border-radius: 1.25rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.03);
            cursor: pointer;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        .product-card:hover {
            transform: translateY(-5px); 
            box-shadow: 0 16px 30px rgba(236, 72, 153, 0.15);
            border-color: #FBCFE8;
        }
        .product-card-image-wrapper { transition: transform 0.5s ease; width: 100%; height: 100%; object-fit: cover;}
        .group:hover .product-card-image-wrapper { transform: scale(1.08); }

        /* Scrollbar styling */
        .category-scrollbar::-webkit-scrollbar { height: 4px; }
        .category-scrollbar::-webkit-scrollbar-track { background: #FDF2F8; border-radius: 10px; }
        .category-scrollbar::-webkit-scrollbar-thumb { background: #FBCFE8; border-radius: 10px; }
        .category-scrollbar::-webkit-scrollbar-thumb:hover { background: #F9A8D4; }
        .category-scrollbar { scrollbar-width: thin; scrollbar-color: #FBCFE8 #FDF2F8; }
        
        /* Spec List Styling */
        .spec-list { margin-left: 0; padding-left: 0; list-style: none; }
        .spec-list li:before {
            content: "‚Ä¢"; 
            color: #DB2777; 
            font-size: 1.5rem; 
            font-weight: bold;
            display: inline-block;
            position: absolute;
            left: 0; 
            top: -0.1rem; 
            line-height: 1;
        }
        
        /* Modern Review Card */
        .modern-review-card {
            background-color: #fff;
            border-radius: 1rem;
            padding: 1rem;
            margin-bottom: 1rem;
            border: 1px solid #F3F4F6;
            box-shadow: 0 2px 8px rgba(0,0,0,0.03);
            transition: transform 0.2s;
        }
        .modern-review-card:hover {
            border-color: #FBCFE8;
            background-color: #FFFDFE;
        }
        
        /* Animations */
        .animated-section {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .animated-section.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Testimonial Slider */
        .testimonial-slider-wrapper { overflow: hidden; width: 100%; touch-action: pan-y; }
        .testimonial-slider { display: flex; transition: transform 0.5s ease-out; will-change: transform; }
        .testimonial-slide-item { flex-shrink: 0; padding: 0 0.5rem; box-sizing: border-box; }
        
        .testimonial-item {
            background-color: white;
            border: none;
            border-bottom: 4px solid #FBCFE8; 
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: 0 6px 16px rgba(0,0,0,0.05);
            min-height: 14rem; 
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
        }
        .testimonial-item:hover { transform: scale(1.01); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        
        /* About Slider */
        .about-slide-item { flex-shrink: 0; padding: 0 0.75rem; box-sizing: border-box; }
        .about-feature-item {
            background-color: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            min-height: 15rem; 
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .about-slider-wrapper { overflow: hidden; width: 100%; touch-action: pan-y; }
        .about-slider { display: flex; transition: transform 0.5s ease-out; will-change: transform; }

        .counter-plain { padding: 1.5rem 2rem; transition: all 0.5s ease; }
        .hero-text-shadow { text-shadow: 0 2px 10px rgba(0,0,0,0.5); }

        /* Custom Styles for Modern Rating */
        .bar-chart-bar { transition: width 0.7s ease-out; }
        .rating-star-icon { transition: transform 0.1s ease, color 0.1s ease; }
        .rating-star-icon:hover { transform: scale(1.1); cursor: pointer; }
        
        /* Gold Gradient */
        .gold-gradient-text {
            background-image: linear-gradient(135deg, #FFD700 20%, #FFA500 80%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            color: transparent;
            font-weight: 900;
        }
        
        /* Glassmorphism Effect */
        .glass-card {
            background-color: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.05);
        }
        
        /* Bar Chart Styles */
        .bar-chart-5 { background-image: linear-gradient(to right, #FFD700, #FFA500); }
        .bar-chart-4 { background-color: #FBBF24; /* Amber */ }
        .bar-chart-3 { background-color: #3B82F6; /* Blue */ }
        .bar-chart-2 { background-color: #F97316; /* Orange */ }
        .bar-chart-1 { background-color: #EF4444; /* Red */ }
    </style>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" media="print" onload="this.media='all'">
    <noscript>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    </noscript>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

</head>
<body class="bg-pink-50 text-gray-700">

    <div class="bg-pink-600 text-white text-center py-2 px-6 text-sm font-semibold">
        <i class="fas fa-gem mr-2"></i> Sentuhan Indah untuk Setiap Detikmu <i class="fas fa-gem ml-2"></i>
    </div>

    <nav class="bg-white/95 backdrop-blur-md sticky top-0 z-50 shadow-sm transition-all duration-300">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#" class="text-3xl font-bold text-pink-600 tracking-tight" aria-label="Kaelyshp Homepage">kaelyshp</a>
            
            <div class="space-x-8 hidden md:flex items-center font-medium">
                <a href="#produk" class="text-gray-600 hover:text-pink-600 transition-colors">Produk</a>
                <a href="#jaminan" class="text-gray-600 hover:text-pink-600 transition-colors">Keunggulan</a>
                <a href="#testimoni" class="text-gray-600 hover:text-pink-600 transition-colors">Testimoni</a>
                <a href="#faq" class="text-gray-600 hover:text-pink-600 transition-colors">FAQ</a>
                <a href="#tentang" class="text-gray-600 hover:text-pink-600 transition-colors">Tentang Kami</a>
            </div>
            
            <button id="mobile-menu-btn" class="md:hidden text-gray-700 z-50 p-2" aria-label="Toggle Mobile Menu">
                <i class="fas fa-bars h-6 w-6"></i>
            </button>
        </div>
        
        <div id="mobile-menu" class="hidden md-hidden absolute top-full left-0 w-full bg-white shadow-xl border-t border-gray-100">
            <a href="#produk" class="block py-3 px-6 text-gray-700 hover:bg-pink-50 font-medium">Produk</a>
            <a href="#jaminan" class="block py-3 px-6 text-gray-700 hover:bg-pink-50 font-medium">Keunggulan</a>
            <a href="#testimoni" class="block py-3 px-6 text-gray-700 hover:bg-pink-50 font-medium">Testimoni</a>
            <a href="#faq" class="block py-3 px-6 text-gray-700 hover:bg-pink-50 font-medium">FAQ</a>
            <a href="#tentang" class="block py-3 px-6 text-gray-700 hover:bg-pink-50 font-medium">Tentang Kami</a>
        </div>
    </nav>

    <header class="relative w-full h-[600px] md:h-[700px] flex items-center justify-center overflow-hidden">
        <div class="absolute inset-0 z-0">
             <picture>
                <source srcset="model.webp" type="image/webp">
                <img 
                    src="model.jpg" 
                    alt="Model Skincare dan Fashion Kaelyshp" 
                    class="w-full h-full object-cover object-top" 
                    fetchpriority="high"
                    width="1920"
                    height="1080"
                    decoding="async"
                    onerror="this.onerror=null;this.src='https://placehold.co/1920x1080/FCE7F3/DB2777?text=Hero+Image';"
                >
            </picture>
            <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-black/20 md:bg-gradient-to-r md:from-black/70 md:via-transparent md:to-transparent"></div>
        </div>

        <div class="container mx-auto px-6 relative z-10 text-center md:text-left h-full flex flex-col justify-center md:justify-center">
            <div class="animated-section max-w-2xl" data-animate data-delay="0">
                <span class="inline-block py-1 px-3 rounded-full bg-pink-600/90 text-white text-xs font-bold uppercase tracking-wider mb-4 shadow-lg backdrop-blur-sm">
                    ‚ú® New Collection 2025
                </span>
                <h1 class="text-4xl sm:text-5xl md:text-7xl font-extrabold text-white mb-6 leading-tight hero-text-shadow">
                    Kurasi Terbaik <br>
                    <span class="text-pink-300">Skincare & Body Care</span>
                </h1>
                <p class="text-lg md:text-xl text-gray-100 mb-8 leading-relaxed max-w-lg mx-auto md:mx-0 hero-text-shadow">
                    Temukan produk viral pilihan yang 100% Original dan BPOM. Kami memilah yang terbaik agar Anda tidak perlu ragu lagi.
                </p>
                
                <div class="flex flex-col sm:flex-row gap-4 justify-center md:justify-start">
                    <a href="#produk" class="bg-pink-600 text-white py-4 px-10 rounded-full font-bold text-lg transition-all hover:bg-pink-500 hover:shadow-xl hover:-translate-y-1 ring-4 ring-pink-600/30">
                        Belanja Sekarang
                    </a>
                    <a href="#testimoni" class="bg-white/10 backdrop-blur-md border border-white/50 text-white py-4 px-10 rounded-full font-bold text-lg transition-all hover:bg-white hover:text-pink-600">
                        Lihat Testimoni
                    </a>
                </div>
            </div>
        </div>
    </header>

    <section id="jaminan" class="bg-white py-10 overflow-hidden animated-section shadow-sm relative z-20 -mt-8 mx-4 md:mx-auto md:max-w-5xl rounded-xl border border-gray-100" data-animate>
        <div class="container mx-auto px-6">
            <div class="relative max-w-3xl mx-auto">
                <div id="trust-slider-track" class="flex transition-transform duration-700 ease-in-out">
                    <div class="w-full flex-shrink-0">
                        <div class="text-center px-4">
                            <div class="flex items-center justify-center mb-2">
                                <div class="w-12 h-12 bg-pink-100 rounded-full flex items-center justify-center">
                                    <i class="fas fa-shield-halved text-pink-600 text-xl"></i>
                                </div>
                            </div>
                            <h3 class="text-base font-bold text-gray-800">100% Original & BPOM</h3>
                            <p class="text-gray-500 text-sm">Garansi uang kembali jika produk palsu.</p>
                        </div>
                    </div>
                    <div class="w-full flex-shrink-0">
                        <div class="text-center px-4">
                            <div class="flex items-center justify-center mb-2">
                                <div class="w-12 h-12 bg-pink-100 rounded-full flex items-center justify-center">
                                    <i class="far fa-credit-card text-pink-600 text-xl"></i>
                                </div>
                            </div>
                            <h3 class="text-base font-bold text-gray-800">Pembayaran Aman</h3>
                            <p class="text-gray-500 text-sm">Transaksi terpercaya via Shopee.</p>
                        </div>
                    </div>
                    <div class="w-full flex-shrink-0">
                        <div class="text-center px-4">
                            <div class="flex items-center justify-center mb-2">
                                <div class="w-12 h-12 bg-pink-100 rounded-full flex items-center justify-center">
                                    <i class="fas fa-star text-pink-600 text-xl"></i>
                                </div>
                            </div>
                            <h3 class="text-base font-bold text-gray-800">Produk Pilihan Terbaik</h3>
                            <p id="review-counter-target" class="text-lg font-bold text-gray-800">Rating 4.8+</p>
                            <p class="text-gray-500 text-sm mt-0">Hanya menjual produk berkualitas.</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="trust-slider-dots" class="flex justify-center space-x-2 mt-4"></div>
        </div>
    </section>

    <main id="produk" class="container mx-auto px-6 py-16">
        <div class="text-center mb-12 animated-section counter-plain" id="customer-counter-section" data-animate>
            <p class="text-5xl md:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-600 mb-2" id="customer-counter-target">0</p>
            <p class="text-gray-600 font-medium text-lg">Pelanggan Puas & Terkurasi ‚úîÔ∏è</p>
        </div>

        <div class="mb-10 animated-section" data-animate>
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-8">Pilih Kategori Favoritmu</h2>
            <div id="category-tabs" class="flex flex-nowrap space-x-3 overflow-x-auto pb-6 category-scrollbar justify-start md:justify-center px-4">
                <button class="category-btn flex-shrink-0 whitespace-nowrap bg-pink-600 text-white py-3 px-6 rounded-full text-sm font-semibold transition-all hover:shadow-lg hover:-translate-y-1 shadow-md" data-category="all">‚úîÔ∏è Semua</button>
                <button class="category-btn flex-shrink-0 whitespace-nowrap bg-white text-gray-600 hover:bg-pink-50 py-3 px-6 rounded-full text-sm font-semibold transition-all hover:shadow-lg border border-gray-100" data-category="skincare">Skincare</button>
                <button class="category-btn flex-shrink-0 whitespace-nowrap bg-white text-gray-600 hover:bg-pink-50 py-3 px-6 rounded-full text-sm font-semibold transition-all hover:shadow-lg border border-gray-100" data-category="bodylotion">Body Lotion</button>
            </div>
        </div>

        <div id="product-grid" class="grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-8 min-h-[500px]"></div>
    </main>

    <section id="testimoni" class="bg-gradient-to-b from-pink-50 to-white py-20 animated-section" data-animate>
        <div class="container mx-auto px-6 max-w-6xl">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-4">Kata Mereka Tentang Kami</h2>
                <div class="w-20 h-1 bg-pink-500 mx-auto rounded-full"></div>
            </div>
            
            <div class="relative testimonial-slider-wrapper">
                <div id="testimoni-slider-track" class="testimonial-slider"></div>
            </div>
            <div id="testimoni-dots" class="flex justify-center space-x-2 mt-8"></div>
        </div>
    </section>
    
    <!-- BAGIAN BARU: PENILAIAN TOKO (STORE RATING) -->
    <section id="store-rating" class="bg-pink-50 py-16 animated-section" data-animate>
        <div class="container mx-auto px-6 max-w-5xl">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-10">Transparansi Penilaian Toko</h2>
            
            <div class="bg-white p-6 md:p-8 rounded-3xl glass-card border border-pink-100 shadow-xl grid grid-cols-1 md:grid-cols-2 gap-8">
                
                <!-- Kiri: Angka Besar & Status -->
                <div class="border-b md:border-b-0 md:border-r border-pink-100 md:pr-8 pb-6 md:pb-0 text-center flex flex-col justify-center items-center">
                    <p class="text-xl font-semibold text-gray-600 mb-2 flex items-center">
                        <span class="relative flex h-3 w-3 mr-2">
                            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                            <span class="relative inline-flex rounded-full h-3 w-3 bg-green-500"></span>
                        </span>
                        Update Real-time 
                    </p>
                    <p class="text-7xl font-extrabold leading-none gold-gradient-text" id="average-score">--</p>
                    
                    <div id="average-stars" class="flex justify-center text-3xl text-yellow-500 my-4">
                        <!-- Bintang Rata-Rata Dimuat dari Firestore -->
                    </div>
                    <p class="text-sm text-gray-500" id="total-votes">Total: 0 Penilaian</p>
                    <p class="text-xs text-gray-400 mt-2 flex items-center gap-1">
                        <i class="fas fa-check-double text-pink-500"></i> Verified by System
                    </p>
                </div>
                
                <!-- Kanan: Bar Chart Distribusi -->
                <div id="rating-distribution" class="pt-6 md:pt-0">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Distribusi Bintang</h3>
                    <!-- Bar Chart akan di-render di sini -->
                </div>

            </div>
            
            <!-- Rating Submission Form -->
            <div id="rating-form-container" class="mt-12 bg-pink-100 p-6 rounded-2xl shadow-inner border border-pink-200">
                <h3 class="text-xl font-bold text-gray-800 mb-4 text-center">Beri Penilaian Anda</h3>
                
                <div id="rating-stars-input" class="flex justify-center space-x-2 mb-4">
                    <!-- Bintang Interaktif untuk Input Nilai -->
                </div>
                
                <p id="rating-feedback-emoji" class="text-center text-2xl font-bold text-gray-800 h-8 mb-4">
                    <!-- Emoticon berubah sesuai rating -->
                </p>
                
                <button id="submit-rating-btn" class="w-full bg-pink-600 text-white py-3 rounded-xl font-bold transition-all hover:bg-pink-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2">
                    <i class="fas fa-paper-plane"></i> Kirim Penilaian
                </button>
                <p id="rating-message" class="text-sm text-center mt-3 text-gray-600">Silakan berikan bintang 1 sampai 5. Anda hanya dapat menilai sekali.</p>

                <!-- Post-Submit CTA -->
                <div id="post-submit-cta" class="hidden mt-6 pt-4 border-t border-pink-200 text-center">
                    <h4 class="text-lg font-bold text-pink-700 mb-3">Penilaian Selesai!</h4>
                    <a href="#produk" class="bg-pink-500 text-white py-3 px-6 rounded-full font-bold inline-flex items-center gap-2 hover:bg-pink-600 transition-colors">
                        <i class="fas fa-heart"></i> Cek Produk Rekomendasi Kami
                    </a>
                </div>
            </div>
        </div>
    </section>
    <!-- AKHIR BAGIAN PENILAIAN TOKO -->

    <section id="faq" class="bg-white py-16 animated-section" data-animate>
        <div class="container mx-auto px-6 max-w-3xl">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-10">Pertanyaan Umum (FAQ)</h2>
            <div class="space-y-4">
                <div class="bg-white p-5 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-shadow">
                    <button class="accordion-button w-full flex justify-between items-center text-left" aria-expanded="false" aria-controls="faq-content-1">
                        <span class="text-lg font-semibold text-gray-800">Apakah produknya 100% Original?</span>
                        <svg class="arrow w-6 h-6 text-pink-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="accordion-content mt-2" id="faq-content-1">
                        <p class="text-gray-600">
                            Tentu! Kami menjamin 100% keaslian semua produk. Kami mengambil langsung dari distributor resmi dan setiap produk sudah terdaftar BPOM (untuk kecantikan).
                        </p>
                    </div>
                </div>
                <div class="bg-white p-5 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-shadow">
                    <button class="accordion-button w-full flex justify-between items-center text-left" aria-expanded="false" aria-controls="faq-content-2">
                        <span class="text-lg font-semibold text-gray-800">Bagaimana cara memesannya?</span>
                        <svg class="arrow w-6 h-6 text-pink-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="accordion-content mt-2" id="faq-content-2">
                        <p class="text-gray-600">
                            Sangat mudah! Cukup klik produk yang Anda suka untuk melihat detail, lalu klik tombol "Beli Aman di Shopee". Anda akan langsung diarahkan ke halaman Shopee kami untuk checkout.
                        </p>
                    </div>
                </div>
                <div class="bg-white p-5 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-shadow">
                    <button class="accordion-button w-full flex justify-between items-center text-left" aria-expanded="false" aria-controls="faq-content-3">
                        <span class="text-lg font-semibold text-gray-800">Berapa lama proses pengirimannya?</span>
                        <svg class="arrow w-6 h-6 text-pink-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="accordion-content mt-2" id="faq-content-3">
                        <p class="text-gray-600">
                            Semua proses pengiriman mengikuti standar Shopee. Kami memproses pesanan di hari yang sama (untuk pembayaran sebelum jam 15.00) dan sisanya mengikuti estimasi dari jasa kirim yang Anda pilih di Shopee.
                        </p>
                    </div>
                </div>
                   <div class="bg-white p-5 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-shadow">
                    <button class="accordion-button w-full flex justify-between items-center text-left" aria-expanded="false" aria-controls="faq-content-4">
                        <span class="text-lg font-semibold text-gray-800">Bagaimana saya tahu stok produknya ready?</span>
                        <svg class="arrow w-6 h-6 text-pink-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="accordion-content mt-2" id="faq-content-4">
                        <p class="text-gray-600">
                            Semua stok produk kami sinkron secara real-time dengan stok di Shopee. Selama produk bisa dimasukkan ke keranjang di Shopee, berarti produk tersebut 100% siap untuk dikirim.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <section id="tentang" class="bg-white py-16 border-t border-pink-100 animated-section" data-animate>
        <div class="container mx-auto px-6 max-w-5xl">
            <div class="text-center mb-10">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Kenapa Memilih kaelyshp?</h2>
                <p class="text-gray-600 leading-relaxed max-w-3xl mx-auto text-lg">
                    Kami lebih dari sekadar toko online. Kami adalah asisten belanja pribadi Anda yang memastikan setiap Rupiah yang Anda keluarkan mendapatkan kualitas terbaik.
                </p>
            </div>
            
            <div class="relative about-slider-wrapper">
                <div id="about-slider-track" class="about-slider">
                    <div class="about-slide-item" data-id="1">
                        <div class="about-feature-item text-center space-y-4 hover:border-pink-300 border border-transparent transition-all">
                            <div class="w-20 h-20 bg-pink-100 rounded-full flex items-center justify-center mx-auto">
                                <i class="fas fa-microscope text-4xl text-pink-600"></i>
                            </div>
                            <h3 class="text-xl font-bold text-gray-800">Kurasi Ultra Ketat</h3>
                            <p class="text-gray-600 text-sm leading-relaxed">
                                Kami menganalisis rating, membaca ribuan ulasan, dan memastikan efikasi terbukti. Kami adalah filter Anda di tengah banyaknya pilihan.
                            </p>
                        </div>
                    </div>
                    <div class="about-slide-item" data-id="2">
                        <div class="about-feature-item text-center space-y-4 hover:border-pink-300 border border-transparent transition-all">
                             <div class="w-20 h-20 bg-pink-100 rounded-full flex items-center justify-center mx-auto">
                                <i class="fas fa-certificate text-4xl text-pink-600"></i>
                            </div>
                            <h3 class="text-xl font-bold text-gray-800">Jaminan Otentik</h3>
                            <p class="text-gray-600 text-sm leading-relaxed">
                                Semua produk dijamin 100% Original dan bersertifikasi resmi BPOM. Kami hanya bekerja sama dengan distributor terverifikasi.
                            </p>
                        </div>
                    </div>
                    <div class="about-slide-item" data-id="3">
                        <div class="about-feature-item text-center space-y-4 hover:border-pink-300 border border-transparent transition-all">
                             <div class="w-20 h-20 bg-pink-100 rounded-full flex items-center justify-center mx-auto">
                                <i class="fas fa-hand-holding-dollar text-4xl text-pink-600"></i>
                            </div>
                            <h3 class="text-xl font-bold text-gray-800">Harga Terbaik</h3>
                            <p class="text-gray-600 text-sm leading-relaxed">
                                Kami memastikan harga kompetitif. Transaksi aman dan transparan melalui platform Shopee, menjamin perlindungan konsumen.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div id="about-dots" class="flex justify-center space-x-2 mt-6"></div>
        </div>
    </section>

    <section id="cta" class="bg-pink-100 py-16 animated-section" data-animate>
        <div class="container mx-auto px-6 text-center max-w-2xl">
            <h2 class="text-3xl font-bold text-gray-800 mb-4">Jangan Lewatkan Promo!</h2>
            <p class="text-gray-600 leading-relaxed mb-8">
                Dapatkan info produk terbaru dan diskon spesial langsung ke inbox Anda.
            </p>
            
            <div id="newsletter-wrapper" class="max-w-lg mx-auto">
                <form id="newsletter-form" class="flex flex-col sm:flex-row gap-4">
                    <input type="email" placeholder="Masukkan email Anda..." class="flex-grow p-4 rounded-full border border-gray-300 focus:outline-none focus:ring-2 focus:ring-pink-400" required aria-label="Email for Newsletter">
                    <button type="submit" class="bg-pink-600 text-white py-3 px-8 rounded-full font-bold transition-all hover:bg-pink-700 hover:shadow-lg hover:scale-105">
                        Daftar ‚úîÔ∏è
                    </button>
                </form>
                <div id="newsletter-success" class="hidden text-center text-lg font-semibold text-pink-800 bg-pink-200 p-4 rounded-full animate-pulse">
                    ‚úîÔ∏è Terima kasih telah mendaftar!
                </div>
            </div>
            <p class="text-xs text-gray-500 mt-4">Kami menjaga privasi Anda. Bebas spam.</p>
        </div>
    </section>

    <footer class="bg-gray-900 text-white pt-16 pb-8">
        <div class="container mx-auto px-6 grid grid-cols-1 md:grid-cols-3 gap-12">
            <div>
                <h4 class="text-3xl font-bold text-white mb-6 tracking-tight">kaelyshp</h4>
                <p class="text-gray-400 leading-relaxed text-sm">
                    Kurator terdepan yang berfokus pada kualitas. Kami menyajikan produk kecantikan pilihan dengan jaminan 100% Original, BPOM, dan standar mutu tinggi.
                </p>
                <div class="mt-6 flex space-x-4">
                    <a href="#" aria-label="Instagram" class="w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center hover:bg-pink-600 transition-colors"><i class="fab fa-instagram"></i></a>
                    <a href="#" aria-label="TikTok" class="w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center hover:bg-pink-600 transition-colors"><i class="fab fa-tiktok"></i></a>
                </div>
            </div>
            <div>
                <h5 class="text-lg font-bold text-white mb-6 border-b border-gray-700 pb-2 inline-block">Menu Cepat</h5>
                <ul class="space-y-3 text-gray-400 text-sm">
                    <li><a href="#produk" class="hover:text-pink-400 transition-colors">Belanja Produk</a></li>
                    <li><a href="#jaminan" class="hover:text-pink-400 transition-colors">Keunggulan Kami</a></li>
                    <li><a href="#testimoni" class="hover:text-pink-400 transition-colors">Ulasan Pelanggan</a></li>
                    <li><a href="#faq" class="hover:text-pink-400 transition-colors">Bantuan / FAQ</a></li>
                </ul>
            </div>
            <div>
                <h5 class="text-lg font-bold text-white mb-6 border-b border-gray-700 pb-2 inline-block">Official Store</h5>
                <p class="text-gray-400 text-sm mb-4">Temukan kami di marketplace kesayangan Anda:</p>
                <a href="https://s.shopee.co.id/5VNa85hUGp" target="_blank" rel="noopener noreferrer" class="group flex items-center bg-orange-600 hover:bg-orange-700 text-white py-3 px-5 rounded-lg transition-all w-fit">
                    <i class="fas fa-store text-xl mr-3 group-hover:scale-110 transition-transform"></i>
                    <div class="text-left">
                        <div class="text-xs opacity-90">Belanja Aman di</div>
                        <div class="font-bold">Shopee</div>
                    </div>
                </a>
            </div>
        </div>
        <div class="mt-12 pt-8 border-t border-gray-800 text-center">
            <p class="text-gray-500 text-sm">
                &copy; 2025 kaelyshp. Seluruh Hak Cipta Dilindungi.
            </p>
        </div>
    </footer>

    <div id="product-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-[60] flex items-center justify-center p-4 hidden opacity-0 transition-opacity duration-300">
        <div class="bg-white w-full max-w-4xl rounded-2xl shadow-2xl max-h-[90vh] overflow-y-auto relative transform scale-95 transition-transform duration-300" id="modal-content-container">
            <button id="modal-close-btn" class="absolute top-4 right-4 bg-gray-100 hover:bg-gray-200 text-gray-600 w-10 h-10 rounded-full flex items-center justify-center z-10 transition-colors" aria-label="Close Product Details Modal">
                <i class="fas fa-times text-lg"></i>
            </button>
            <div class="p-0 md:p-0 flex flex-col md:flex-row h-full">
                <div class="w-full md:w-5/12 bg-gray-50 flex items-center justify-center p-6 md:p-8">
                    <img id="modal-img" src="" alt="Detail Produk" class="w-full h-auto object-contain rounded-lg shadow-md max-h-[400px]" loading="lazy">
                </div>
                <div class="w-full md:w-7/12 p-6 md:p-8 overflow-y-auto">
                    <span id="modal-category" class="text-xs font-bold text-pink-600 bg-pink-100 px-2 py-1 rounded uppercase tracking-wide mb-2 inline-block">Kategori</span>
                    <h2 id="modal-title" class="text-2xl md:text-3xl font-bold text-gray-900 mb-2 leading-tight">Nama Produk</h2>
                    <div class="flex flex-wrap items-center justify-between mb-6 border-b border-gray-100 pb-4">
                        <div class="flex items-center space-x-2">
                            <div id="modal-stars" class="flex text-yellow-400 text-sm"></div>
                            <span id="modal-rating-text" class="text-sm text-gray-500 font-medium"></span>
                        </div>
                        <p id="modal-price" class="text-3xl font-extrabold text-pink-600">Rp 0</p>
                    </div>
                    <div class="mb-6">
                        <h4 class="font-bold text-gray-900 mb-2 flex items-center"><i class="fas fa-info-circle mr-2 text-pink-500"></i> Deskripsi</h4>
                        <p id="modal-desc" class="text-gray-600 text-sm leading-relaxed whitespace-pre-line bg-gray-50 p-4 rounded-lg border border-gray-100"></p>
                    </div>
                    <div class="mb-8">
                        <h4 class="font-bold text-gray-900 mb-2 flex items-center"><i class="fas fa-list-ul mr-2 text-pink-500"></i> Spesifikasi</h4>
                        <ul id="modal-specs" class="text-gray-600 text-sm spec-list pl-2"></ul>
                    </div>
                    <div class="mb-8">
                        <h4 class="font-bold text-gray-900 mb-4 flex items-center justify-between">
                            <span><i class="fas fa-comment-dots mr-2 text-pink-500"></i> Ulasan Pilihan</span>
                            <span class="text-xs font-normal text-gray-500 bg-gray-100 px-2 py-1 rounded">Terverifikasi ‚úîÔ∏è</span>
                        </h4>
                        <div id="modal-reviews-list" class="space-y-3"></div>
                    </div>
                    <div class="sticky bottom-0 bg-white pt-4 pb-2 border-t border-gray-100 md:static md:border-0 md:pt-0">
                        <a id="modal-shopee-link" href="#" target="_blank" rel="noopener noreferrer" class="w-full bg-pink-600 text-white py-4 px-6 rounded-xl font-bold text-center transition-all hover:bg-pink-700 hover:shadow-lg hover:shadow-pink-200 flex items-center justify-center group">
                            <i class="fas fa-shopping-bag w-5 h-5 mr-2 group-hover:animate-bounce"></i> Beli Aman di Shopee ‚úîÔ∏è
                        </a>
                           <p class="text-xs text-center text-gray-400 mt-2">Dijamin 100% Original & Transaksi Aman</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        // Import modul Firebase yang diperlukan
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, collection, onSnapshot, setDoc, query, getDocs, writeBatch } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js"; 

        // Global Firebase vars
        let app, db, auth;
        let userId = null;
        let userHasRated = false; 
        let selectedRating = 0; 
        let currentDistribution = { 5: 0, 4: 0, 3: 0, 2: 0, 1: 0 };
        const EMOJI_FEEDBACK = {
            5: 'Luar Biasa! üåü (Sangat Puas)',
            4: 'Memuaskan! üëç (Puas)',
            3: 'Cukup Bagus! üÜó (Netral)',
            2: 'Perlu Perbaikan üò• (Kurang Puas)',
            1: 'Kecewa Berat üò° (Buruk)'
        };

        // Global variables for Firebase access (provided by canvas environment)
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : null;
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        // Firestore Collection Path for User Rating Submission (Public Data)
        const USER_RATINGS_COLLECTION = `artifacts/${appId}/public/data/user_ratings`;

        // Mock data for initial seeding (43,872 votes total, heavily skewed towards 5 and 4 stars)
        // DITINGKATKAN: Bintang 5 (70%), Bintang 4 (25%), Bintang 3 (3%), Bintang 2 (1%), Bintang 1 (1%)
        const MOCK_TOTAL_VOTES = 43872;
        const MOCK_DISTRIBUTION = {
            5: Math.floor(MOCK_TOTAL_VOTES * 0.70), // 30710
            4: Math.floor(MOCK_TOTAL_VOTES * 0.25), // 10968
            3: Math.floor(MOCK_TOTAL_VOTES * 0.03), // 1316
            2: Math.floor(MOCK_TOTAL_VOTES * 0.01), // 438
            1: MOCK_TOTAL_VOTES - (Math.floor(MOCK_TOTAL_VOTES * 0.70) + Math.floor(MOCK_TOTAL_VOTES * 0.25) + Math.floor(MOCK_TOTAL_VOTES * 0.03) + Math.floor(MOCK_TOTAL_VOTES * 0.01)), // 440 (Sisa)
        };
        
        // ------------------------------------
        // 1. FIREBASE & RATING LOGIC
        // ------------------------------------

        // New DOM elements for rating (DIPINDAHKAN KE GLOBAL SCOPE)
        const averageStarsContainer = document.getElementById('average-stars');
        const averageScoreElement = document.getElementById('average-score');
        const totalVotesElement = document.getElementById('total-votes');
        const ratingStarsInput = document.getElementById('rating-stars-input');
        const submitRatingBtn = document.getElementById('submit-rating-btn');
        const ratingMessage = document.getElementById('rating-message');
        const reviewCounterTarget = document.getElementById('review-counter-target');
        const ratingDistributionContainer = document.getElementById('rating-distribution');
        const postSubmitCta = document.getElementById('post-submit-cta');
        const ratingFeedbackEmoji = document.getElementById('rating-feedback-emoji');


        async function initFirebase() {
            // 1. Initialization
            try {
                if (!firebaseConfig) {
                    throw new Error("Firebase config not available.");
                }
                app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);
                setLogLevel('debug'); 

                // 2. Authentication (Anonymous Sign-in)
                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken);
                } else {
                    await signInAnonymously(auth);
                }

                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        userId = user.uid;
                        // PENTING: Periksa dan masukkan data awal jika koleksi kosong
                        seedInitialRatings();
                        listenToStoreRatings();
                        checkUserRatingStatus(); 
                    } else {
                        console.error("Authentication failed or user logged out.");
                        userId = null;
                    }
                });

            } catch (error) {
                console.error("Error initializing Firebase or signing in:", error);
                // Fallback UI
                if (averageScoreElement) averageScoreElement.textContent = '‚ùå';
                if (totalVotesElement) totalVotesElement.textContent = 'Gagal memuat rating.';
                if (ratingMessage) ratingMessage.textContent = 'Fitur rating tidak tersedia saat ini.';
                if(submitRatingBtn) submitRatingBtn.disabled = true;
            }
        }
        
        // FUNGSI BARU: Memasukkan data rating awal (Dummy Data) ke Firestore
        async function seedInitialRatings() {
            if (!db) return;

            const ratingsCollectionRef = collection(db, USER_RATINGS_COLLECTION);
            
            try {
                // Periksa apakah dokumen mock sudah ada untuk menghindari seeding berulang
                const mockDataId = 'initial_mock_data'; 
                const mockDocRef = doc(db, USER_RATINGS_COLLECTION, mockDataId);
                const mockDocSnap = await getDocs(query(ratingsCollectionRef));
                
                const mockDocExists = mockDocSnap.docs.some(doc => doc.id === mockDataId);

                // HANYA jika koleksi kosong dan belum ada mock data, kita masukkan data dummy
                if (!mockDocExists) {
                    let totalScore = 0;
                    for (const rating in MOCK_DISTRIBUTION) {
                        totalScore += parseInt(rating) * MOCK_DISTRIBUTION[rating];
                    }
                    const totalVotes = MOCK_TOTAL_VOTES;
                    const averageScore = totalScore / totalVotes;

                    await setDoc(mockDocRef, {
                        totalScore: totalScore,
                        totalCount: totalVotes,
                        distribution: MOCK_DISTRIBUTION,
                        average: parseFloat(averageScore.toFixed(2)),
                        isMock: true,
                        seededAt: new Date().toISOString()
                    });
                    console.log("Mock initial ratings seeded successfully.");
                }

            } catch (error) {
                console.error("Error seeding initial ratings:", error);
            }
        }


        // Check if user has rated and update UI
        async function checkUserRatingStatus() {
            if (!userId || !db) return;

            try {
                // Periksa apakah dokumen dengan UID pengguna saat ini ada (mengindikasikan pengguna telah menilai)
                const ratingsCollectionRef = collection(db, USER_RATINGS_COLLECTION);
                const userRatingSnap = await getDocs(query(ratingsCollectionRef));
                
                // Cari rating pengguna di antara semua dokumen (kecuali mock)
                userHasRated = userRatingSnap.docs.some(doc => doc.id === userId && !doc.data().isMock);

                if (userHasRated) {
                    if(submitRatingBtn) {
                        submitRatingBtn.disabled = true;
                        submitRatingBtn.textContent = '‚úîÔ∏è Penilaian Sudah Diterima';
                    }
                    if(ratingMessage) ratingMessage.textContent = 'Terima kasih atas penilaian Anda! Silakan lihat distribusi rating di sebelah kanan.';
                    if(ratingStarsInput) ratingStarsInput.innerHTML = ''; 
                    if(ratingFeedbackEmoji) ratingFeedbackEmoji.textContent = '';
                    if(postSubmitCta) postSubmitCta.classList.remove('hidden');
                } else {
                    renderRatingInput();
                    if(submitRatingBtn) submitRatingBtn.disabled = (selectedRating === 0);
                    if(submitRatingBtn) submitRatingBtn.textContent = 'Kirim Penilaian';
                    if(ratingMessage) ratingMessage.textContent = 'Silakan berikan bintang 1 sampai 5. Anda hanya dapat menilai sekali.';
                    if(postSubmitCta) postSubmitCta.classList.add('hidden');
                }
            } catch (error) {
                console.error("Error checking user rating status:", error);
            }
        }

        // Listen to all individual ratings (including the mock data) to calculate the aggregate rating (real-time)
        function listenToStoreRatings() {
            if (!db) return;

            const q = query(collection(db, USER_RATINGS_COLLECTION));

            onSnapshot(q, (snapshot) => {
                let totalScore = 0;
                let totalCount = 0;
                let distribution = { 5: 0, 4: 0, 3: 0, 2: 0, 1: 0 };
                
                snapshot.docs.forEach(doc => {
                    const data = doc.data();

                    if (data.isMock) {
                        // Gunakan nilai agregat dari dokumen mock
                        totalScore += data.totalScore || 0;
                        totalCount += data.totalCount || 0;
                        for (const rating in data.distribution) {
                            distribution[rating] += data.distribution[rating];
                        }
                    } else if (typeof data.rating === 'number' && data.rating >= 1 && data.rating <= 5) {
                        // Hitung rating pengguna asli
                        totalScore += data.rating;
                        totalCount++;
                        distribution[data.rating]++;
                    }
                });
                
                currentDistribution = distribution;
                const averageRating = totalCount > 0 ? (totalScore / totalCount) : 0;
                renderRatingDisplay(averageRating, totalCount);
                renderDistributionBar(totalCount);

            }, (error) => {
                console.error("Error fetching real-time ratings:", error);
                if (averageScoreElement) averageScoreElement.textContent = 'ERR';
            });
        }


        // UI Renderers
        function renderDistributionBar(totalCount) {
            if (!ratingDistributionContainer) return;

            // Pastikan totalCount tidak nol untuk menghindari pembagian dengan nol
            const safeTotalCount = totalCount > 0 ? totalCount : 1; 

            let barHTML = `<h3 class="text-xl font-bold text-gray-800 mb-4">Distribusi Bintang</h3>`;
            
            for (let i = 5; i >= 1; i--) {
                const count = currentDistribution[i] || 0;
                const percentage = (count / safeTotalCount) * 100;
                const barWidth = Math.max(percentage, 2); // Minimal 2% untuk visibilitas
                
                // Tentukan class warna bar
                let barClass = '';
                switch(i) {
                    case 5: barClass = 'bar-chart-5'; break;
                    case 4: barClass = 'bar-chart-4'; break;
                    case 3: barClass = 'bar-chart-3'; break;
                    case 2: barClass = 'bar-chart-2'; break;
                    case 1: barClass = 'bar-chart-1'; break;
                }

                barHTML += `
                    <div class="flex items-center mb-3">
                        <span class="text-sm font-bold text-gray-700 w-16 flex-shrink-0 text-left">${i} Bintang (${percentage.toFixed(0)}%)</span>
                        <div class="flex-grow bg-pink-100 rounded-full h-3 mx-2 relative overflow-hidden">
                            <div class="bar-chart-bar h-full rounded-full ${barClass}" style="width: ${barWidth}%;"></div>
                        </div>
                        <span class="text-xs text-gray-500 w-16 text-right font-bold">${count.toLocaleString('id-ID')}</span>
                    </div>
                `;
            }
            ratingDistributionContainer.innerHTML = barHTML;
        }


        function renderRatingDisplay(averageRating, totalCount) {
            const formattedRating = averageRating.toFixed(2); // Ditingkatkan ke 2 desimal
            
            if(averageScoreElement) averageScoreElement.textContent = totalCount > 0 ? formattedRating : 'N/A';
            if(totalVotesElement) totalVotesElement.textContent = `Total: ${totalCount.toLocaleString('id-ID')} Penilaian`;
            
            if(averageStarsContainer) {
                averageStarsContainer.innerHTML = renderStars(averageRating, true); 
            }
            
            if(reviewCounterTarget) {
                 reviewCounterTarget.textContent = totalCount > 0 ? `${averageRating.toFixed(1)}+` : '4.8+';
            }
        }

        function renderRatingInput() {
            if (!ratingStarsInput) return;
            ratingStarsInput.innerHTML = '';
            for (let i = 1; i <= 5; i++) {
                const star = document.createElement('button');
                star.type = 'button';
                star.classList.add('rating-star-icon', 'text-gray-400', 'transition-all', 'text-4xl', 'focus:outline-none', 'p-1');
                star.innerHTML = '<i class="far fa-star"></i>'; 
                star.dataset.value = i;

                star.addEventListener('mouseover', () => updateStarInputDisplay(i));
                star.addEventListener('mouseout', () => updateStarInputDisplay(selectedRating)); 

                star.addEventListener('click', () => {
                    selectedRating = i;
                    updateStarInputDisplay(i);
                    updateEmojiFeedback(i);
                    if(submitRatingBtn) submitRatingBtn.disabled = false;
                });

                ratingStarsInput.appendChild(star);
            }
        }
        
        function updateEmojiFeedback(value) {
            if(ratingFeedbackEmoji) {
                ratingFeedbackEmoji.textContent = EMOJI_FEEDBACK[value] || '';
            }
        }

        function updateStarInputDisplay(value) {
            if (!ratingStarsInput) return;
            Array.from(ratingStarsInput.children).forEach(starBtn => {
                const starValue = parseInt(starBtn.dataset.value);
                const iconElement = starBtn.querySelector('i');
                if (!iconElement) return;

                if (starValue <= value) {
                    iconElement.classList.remove('far', 'fa-star', 'text-gray-400');
                    iconElement.classList.add('fas', 'fa-star', 'text-yellow-500', 'hover:scale-110'); 
                } else {
                    iconElement.classList.remove('fas', 'fa-star', 'text-yellow-500', 'hover:scale-110');
                    iconElement.classList.add('far', 'fa-star', 'text-gray-400');
                }
            });
        }
        
        function triggerConfetti() {
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 },
                colors: ['#EC4899', '#FBCFE8', '#FFD700', '#DB2777']
            });
        }

        // Submit Logic
        async function handleRatingSubmit() {
            if (!userId || selectedRating === 0 || userHasRated || !db) {
                if(ratingMessage) console.error('Rating submission preconditions failed.');
                return;
            }

            if(submitRatingBtn) {
                submitRatingBtn.disabled = true;
                submitRatingBtn.textContent = 'Mengirim...';
            }
            if(ratingMessage) ratingMessage.textContent = 'Sedang memproses penilaian Anda... Mohon tunggu.';

            try {
                // 1. Tambahkan rating pengguna baru
                const userRatingRef = doc(db, USER_RATINGS_COLLECTION, userId);
                await setDoc(userRatingRef, {
                    rating: selectedRating,
                    timestamp: new Date().toISOString(),
                    isMock: false
                });

                userHasRated = true;
                if(submitRatingBtn) submitRatingBtn.textContent = '‚úîÔ∏è Penilaian Sudah Diterima';
                if(ratingMessage) ratingMessage.textContent = 'Terima kasih, penilaian Anda telah direkam!';
                if(ratingStarsInput) ratingStarsInput.innerHTML = '';
                if(ratingFeedbackEmoji) ratingFeedbackEmoji.textContent = '';
                if(postSubmitCta) postSubmitCta.classList.remove('hidden');

                // Confetti for high rating (4 or 5 stars)
                if (selectedRating >= 4) {
                    triggerConfetti();
                }

            } catch (error) {
                console.error("Error submitting rating:", error);
                if(submitRatingBtn) submitRatingBtn.disabled = false;
                if(submitRatingBtn) submitRatingBtn.textContent = 'Gagal Kirim. Coba Lagi.';
                if(ratingMessage) ratingMessage.textContent = `Terjadi kesalahan. Silakan coba lagi.`;
            }
        }

        // Attach event listener
        if (submitRatingBtn) {
            submitRatingBtn.addEventListener('click', handleRatingSubmit);
        }
        
        // ------------------------------------
        // 2. HELPER FUNCTIONS (Diperbarui untuk mendukung Font Awesome)
        // ------------------------------------

        // RENDER STARS (Function to handle both small SVG stars and large FA icons)
        function renderStars(rating, isLarge = false) {
            let starsHTML = '';
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating - fullStars >= 0.5;
            const totalStars = 5;
            let currentStars = 0;

            // FontAwesome icons for large display, SVG for small/product cards
            const fullIcon = isLarge ? '<i class="fas fa-star"></i>' : '<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 7.02l6.572-.955L10 0l2.939 6.065 6.572.955-4.756 4.525 1.123 6.545z"></path></svg>';
            const emptyIcon = isLarge ? '<i class="far fa-star"></i>' : '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.96 6.012h6.324c.969 0 1.371 1.243.588 1.81L17.2 15.655l1.96 6.012c.3.921-.755 1.688-1.54 1.173L12 19.387l-5.62 3.453c-.785.515-1.84-.252-1.54-1.173l1.96-6.012L2.176 10.75c-.783-.567-.38-1.81.588-1.81h6.324l1.96-6.012z"/></svg>'; 
            // Menggunakan Font Awesome Half Star untuk tampilan besar yang lebih akurat
            const halfIcon = isLarge ? '<i class="fas fa-star-half-alt"></i>' : fullIcon; 

            for (let i = 0; i < fullStars; i++) { 
                starsHTML += fullIcon;
                currentStars++;
            }

            if (hasHalfStar && currentStars < totalStars) {
                starsHTML += halfIcon;
                currentStars++;
            }

            while (currentStars < totalStars) {
                starsHTML += emptyIcon;
                currentStars++;
            }

            return starsHTML;
        }

        // ------------------------------------
        // 3. EVENT LISTENERS AND INIT
        // ------------------------------------

        document.addEventListener('DOMContentLoaded', () => {
            
            // LAZY LOAD 3RD PARTY SCRIPTS
            function loadThirdPartyScripts() {
                const adsScript = document.createElement('script');
                adsScript.src = "https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3702965332396950";
                adsScript.crossOrigin = "anonymous";
                adsScript.async = true;
                document.head.appendChild(adsScript);

                const gaScript = document.createElement('script');
                gaScript.src = "https://www.googletagmanager.com/gtag/js?id=G-XEP8BFJK7Q";
                gaScript.async = true;
                document.head.appendChild(gaScript);

                window.dataLayer = window.dataLayer || [];
                function gtag(){dataLayer.push(arguments);}
                gtag('js', new Date());
                gtag('config', 'G-XEP8BFJK7Q');
            }

            let loaded = false;
            function initLazyLoad() {
                if(loaded) return;
                loaded = true;
                setTimeout(loadThirdPartyScripts, 100);
            }

            window.addEventListener('scroll', initLazyLoad, {passive: true});
            window.addEventListener('mousemove', initLazyLoad, {passive: true});
            window.addEventListener('touchstart', initLazyLoad, {passive: true});
            setTimeout(initLazyLoad, 3000);

            // DATA PRODUK (Hanya menyisakan bodylotion/skincare yang disetujui)
            const masterProductList = [
                {
                    id: 1,
                    category: "bodylotion", 
                    name: "PHERINI | Armpit Brightening Cream | Serum Pemutih Ketiak Permanen BPOM",
                    price: "Rp 78.800",
                    imageUrl: "pherini.webp", 
                    shopeeUrl: "https://s.shopee.co.id/6VG8EKd6uO",
                    description: "Krim spesialis viral untuk mencerahkan area lipatan kulit yang gelap seperti ketiak, siku, selangkangan, dan lutut. Diformulasikan khusus dengan Niacinamide, Centella, dan Olive Oil untuk kulit sensitif. Efektif membuat kulit menjadi putih merata, halus, serta mengurangi bau tak sedap dan peradangan. Jaminan hasil optimal dan permanen dengan pemakaian rutin dan konsisten.",
                    specs: "Brand: PHERINI\nVolume: 30ml\nSertifikasi: BPOM RI (NA18211902388)\nManfaat Utama: Serum Pemutih Ketiak Permanen, Mencerahkan lipatan, menghaluskan tekstur, mengurangi bau badan\nKomposisi Aktif: Niacinamide (Pencerah kuat), Olea Europa Oil (Anti-inflamasi), Centella Asiatica Extract (Elastisitas kulit)",
                    review: ["Produk viral yang benar-benar memberikan hasil. Dalam 2 minggu pemakaian, area ketiak terlihat lebih cerah dan jauh lebih halus. Teksturnya non-lengket dan cepat meresap. Sangat direkomendasikan.", "Sangat membantu mengatasi masalah lipatan hitam di siku dan lutut. Wanginya lembut dan tidak menyengat. Akan repurchase terus!", "Krim pencerah ketiak terbaik yang pernah saya coba. Tidak ada efek samping, aman, dan sudah BPOM. Hasilnya terlihat permanen jika dipakai rutin."],
                    rating: 4.8,
                    reviewCount: 36400 
                },
                {
                    id: 4,
                    category: "bodylotion", 
                    name: "Lavojoy | Daily Shine Body Serum SPF 50 Tone Up | Skincare Viral Pencerah Instan",
                    price: "Rp 67.000",
                    imageUrl: "lavojoy.webp",
                    shopeeUrl: "https://s.shopee.co.id/9pWaG7Zdw7",
                    description: "Body Serum Lavojoy Delicate Rose, Skincare Viral yang memberikan perlindungan matahari superior (SPF 50 PA++++) sekaligus efek pencerah instan (Instant Tone-up) yang natural. Formula non-lengket ini diperkaya 3% Niacinamide dan Ceramide untuk mencerahkan, memperkuat skin barrier, dan hidrasi maksimal. Produk perawatan harian efektif dan beraroma mewah.",
                    specs: "Brand: Lavojoy\nVolume: 180ml\nPerlindungan UV: SPF 50 PA++++ (Proteksi Harian)\nKandungan Aktif: 3% Niacinamide, Ceramide, 6X Hyaluronic Acid\nManfaat: Skincare Viral, Mencerahkan Instan, Melindungi Kulit, Tone-Up\nVarian Shade: 00 Silk White, 01 Cream Beige, 02 Warm Sand",
                    review: ["Wanginya sangat mewah, mirip parfum mahal dan tahan lama. Efek tone up-nya natural, tidak membuat kulit terlihat abu-abu. Cepat meresap dan sangat praktis karena sudah ada SPF 50.", "Penyelamat di siang hari! Tone up-nya instan dan tidak luntur saat berkeringat. Kulit jadi glowing sehat seharian.", "Baru pertama coba dan langsung jatuh cinta! Kulit jadi lembap dan wanginya disukai banyak orang. Benar-benar worth the hype."],
                    rating: 4.8,
                    reviewCount: 72500 
                },
                {
                    id: 5,
                    category: "bodylotion", 
                    name: "Purbasari | White Glow Body Serum | Pemutih Kulit Viral BPOM Halal",
                    price: "Rp 27.400",
                    imageUrl: "purbasari.webp",
                    shopeeUrl: "https://s.shopee.co.id/3LJ6WKlPaS",
                    description: "Body serum viral dengan aroma floral segar yang memberikan efek Instant White dan Glow tanpa meninggalkan rasa lengket. Formula ini memiliki 3X Active Whitening (Niacinamide, Ekstrak Radiant White, dan Ekstrak Bengkoang) yang bekerja sinergis untuk mencerahkan kulit secara bertahap dan melindunginya dari sinar UV. Produk pemutih kulit yang ringan dan efektif.",
                    specs: "Brand: Purbasari\nTipe: Body Serum (Instant White Glow)\nVolume: 180ml\nManfaat: Pemutih Kulit Viral, Mencerahkan, Perlindungan UV\nKandungan Aktif: 2% Niacinamide, Ekstrak Radiant White, Ekstrak Bengkoang\nKeunggulan: Tekstur ringan, cepat meresap, Halal dan BPOM (NA18220109846)",
                    review: ["Body serum dengan harga yang sangat terjangkau namun memberikan kualitas juara. Kulit saya jadi lebih cerah dan lembap. Aromanya soft dan enak. Pasti beli lagi.", "Teksturnya seperti air, sangat ringan dan langsung meresap. Efek mencerahkannya terasa setelah rutin 1 bulan. Terbaik di kelasnya!", "Cocok untuk kulit berminyak karena tidak lengket. Wangi floralnya tahan lama. Kulit terlihat lebih sehat dan plump."],
                    rating: 4.8,
                    reviewCount: 15400 
                },
                {
                    id: 7,
                    category: "bodylotion",
                    name: "MOOI | Brightening Tone Up Booster Body Lotion SPF 30 | 10X Pencerah Kulit Viral",
                    price: "Rp 49.900",
                    imageUrl: "moik.webp", 
                    shopeeUrl: "https://s.shopee.co.id/12eYR1j7z",
                    description: "Body Lotion Tone Up Viral dari MOOI dengan formula 10X Extra Brightening Power (Glutathio & Niacinamide). Memberikan efek cerah natural yang tahan lama dan melindungi kulit dari matahari (UV Filter setara SPF 30). Mengandung Red Alga dan Allantoin untuk mencerahkan, meratakan warna, dan menutrisi kulit secara intensif. Hasil kulit cerah instan dan terlindungi.",
                    specs: "Brand: MOOI Pure Glow\nVolume: 120gr\nPerlindungan: UV Filter (Setara SPF 30)\nManfaat Utama: 10X Pencerah Kulit Viral, Instant Tone Up, Proteksi UV\nKandungan Aktif: Niacinamide, Glutathio, Red Alga, Allantoin\nKeunggulan: Non-Sticky, Fragrance White Floral Tahan Lama. BPOM (NA18240111449)",
                    review: ["Efek tone up-nya sangat natural, tidak terlihat dempul sama sekali. Wanginya enak, menempel seharian. Formula 10X Brightening-nya terasa bekerja di kulit. Sangat direkomendasikan.", "Teksturnya cepat meresap dan tidak meninggalkan residu putih. Kulit saya jadi lebih glowing dan lembap. Harga terjangkau untuk manfaat sebanyak ini.", "Saya suka desain kemasannya yang travel-friendly. Efek tone up-nya bekerja sempurna di kulit sawo matang."],
                    rating: 4.8,
                    reviewCount: 27800 
                },
                {
                    id: 9,
                    category: "bodylotion",
                    name: "Grace and Glow | Brightening Sun Body Serum SPF 30 | Body Serum Pemutih & Parfum Viral",
                    price: "Rp 36.900",
                    imageUrl: "grace.webp",
                    shopeeUrl: "https://s.shopee.co.id/3qFN7hYGaJ",
                    description: "Body Serum multifungsi Viral yang memadukan pencerahan, perlindungan, dan aroma mewah. Melindungi kulit dari sinar UV (SPF 30 PA+++) dan mencerahkan dengan Alpha Arbutin dan Bearberry Extract. Memiliki keharuman premium yang terinspirasi dari parfum mahal. Tekstur ringan, cepat meresap, dan non-lengket, menjadikannya serum pemutih harian yang komplit.",
                    specs: "Brand: Grace and Glow\nVolume: 100ml\nPerlindungan UV: SPF 30 PA+++\nManfaat: Body Serum Pemutih Viral, Melindungi, Parfum Mewah Tahan Lama\nKandungan Aktif: Alpha Arbutin, Bearberry Extract, UV Filter\nBPOM: NA18220104829",
                    review: ["Ini body serum sekaligus parfum. Wanginya sangat tahan lama dan mewah. Teksturnya ringan di kulit dan ada SPF 30-nya. Produk yang sangat komplit untuk perawatan harian.", "Aromanya benar-benar terinspirasi dari parfum high-end. Kulit jadi lembap dan wangi sepanjang hari tanpa perlu pakai parfum lagi. Kualitas terbaik!", "Saya suka karena ada Alpha Arbutin untuk mencerahkan. Formula ini ringan di kulit dan tidak pilling."],
                    rating: 4.9,
                    reviewCount: 215900 
                },
                {
                    id: 10,
                    category: "bodylotion",
                    name: "NIVEA | Body Lotion Extra White Brightening 190ML | Pemutih Kulit Cepat Vitamin C",
                    price: "Rp 27.500",
                    imageUrl: "nivea.webp",
                    shopeeUrl: "https://s.shopee.co.id/4AsDWQdFCt",
                    description: "Body Lotion teruji klinis dari NIVEA yang efektif mencerahkan kulit secara intensif. Diperkaya konsentrasi tinggi Vitamin C dan UV Filter untuk melindungi kulit dari kerusakan dan kekusaman harian. Formula NIVEA yang ringan, cepat meresap, dan non-sticky, ideal untuk menjaga kelembapan kulit normal hingga kering. Solusi pemutih kulit cepat dan aman.",
                    specs: "Brand: NIVEA\nVarian: Extra White Brightening\nVolume: 190ML\nManfaat Utama: Pemutih Kulit Cepat, Mencerahkan klinis, Melembapkan\nKandungan Utama: Vitamin C, UV Filter\nKeunggulan: Formula Non-Sticky, Teruji Klinis",
                    review: ["Selalu jadi anadalan untuk kulit kering. Lembapnya maksimal, cerahnya juga terasa. Wanginya lembut dan khas NIVEA. Produk yang konsisten dan berkualitas tinggi.", "Cocok untuk kulit sensitif, tidak menimbulkan iritasi. Efek melembapkannya tahan lama bahkan di ruangan ber-AC.", "NIVEA memang tidak pernah mengecewakan. Harga terjangkau, kualitas bintang lima. Kulit terlihat lebih sehat dan halus."],
                    rating: 4.9,
                    reviewCount: 10000
                },
                {
                    id: 11,
                    category: "bodylotion",
                    name: "Purbasari BUNDLE | Body Serum Pemutih Gluta Hya + White Glow | Perawatan Kulit Viral",
                    price: "Rp 47.500",
                    imageUrl: "glutanya.webp",
                    shopeeUrl: "https://s.shopee.co.id/3VcWjJm67t",
                    description: "Paket Body Serum super hemat yang menggabungkan dua formula pencerah terlaris Purbasari: White Glow (Instant White) dan Gluta Hya/Cybright (Pencerahan Powerful, Meremajakan, Anti-UV). Solusi lengkap 2-in-1 untuk kulit cerah, lembap, terlindungi, dan terawat dengan harga terbaik. Cocok untuk skincare routine pagi dan malam.",
                    specs: "Brand: Purbasari\nIsi Paket: 2 Botol Body Serum (Gluta Hya/Cybright & White Glow)\nVolume: 2 x 180ml\nManfaat Utama: Pencerahan superior, Instant Glow, Perlindungan UV, Meremajakan Kulit\nBPOM: NA18220109846, NA18240102926",
                    review: ["Sangat hemat beli paket bundle ini. Bisa pakai White Glow di pagi hari dan Gluta Hya/Cybright untuk malam hari. Kedua serum efektif mencerahkan dan menghidrasi kulit. Highly recommended.", "Kualitas serumnya ringan dan cepat meresap. Kulit jadi terasa lembut dan lebih kenyal setelah pemakaian rutin.", "Harga bundelnya murah banget! Saya suka keduanya, memberikan efek cerah yang berbeda-beda. Pilihan terbaik untuk perawatan lengkap."],
                    rating: 4.9,
                    reviewCount: 2500 
                },
                {
                    id: 12,
                    category: "bodylotion",
                    name: "Lavojoy [Share in Jar] | Daily Shine Body Serum Tone Up | Tester Hemat BPOM",
                    price: "Rp 10.000",
                    imageUrl: "rum.webp",
                    shopeeUrl: "https://s.shopee.co.id/50RKWBYbt3",
                    description: "Pilihan ideal dan higienis untuk mencoba dan menentukan kecocokan shade Lavojoy Daily Shine Body Serum sebelum membeli ukuran penuh. Produk yang kami jual 100% original, dikemas ulang secara steril (Share in Jar). Solusi hemat dan aman untuk tester produk viral Tone Up.",
                    specs: "Tipe: Share in Jar (Kemasan Ulang/Tester)\nProduk: Lavojoy Daily Shine Body Serum\nUkuran Varian: 5ml atau 10ml\nJaminan: Produk 100% Original, Proses Pemindahan Higienis, Solusi Hemat",
                    review: ["Terima kasih untuk opsi testernya. Sangat membantu untuk memastikan kecocokan shade. Produk original dan wadahnya higienis. Pasti akan beli ukuran besar setelah ini.", "Kemasan share in jar yang aman dan tidak tumpah. Saya bisa coba dulu sebelum beli full size. Lavojoy memang sebagus itu!", "Baru pertama kali coba, dan ternyata wanginya enak banget. Cepat meresap dan efek tone up-nya langsung terlihat. Puas dengan testernya."],
                    rating: 4.0,
                    reviewCount: 2000 
                }
            ];

            const productGrid = document.getElementById('product-grid');
            const modal = document.getElementById('product-modal');
            const modalCloseBtn = document.getElementById('modal-close-btn');
            const modalContent = document.getElementById('modal-content-container');
            const categoryTabs = document.querySelectorAll('.category-btn');
            
            const newsletterForm = document.getElementById('newsletter-form');
            const newsletterSuccess = document.getElementById('newsletter-success');
            const customerCounterTarget = document.getElementById('customer-counter-target');
            const testimoniSliderTrack = document.getElementById('testimoni-slider-track');
            const testimoniDotsContainer = document.getElementById('testimoni-dots');
            // reviewCounterTarget sudah dideklarasikan di scope global Firebase

            // INDONESIAN NAMES & REVIEWS
            const indonesianNames = [
                "Rina Amelia", "Sari Murni", "Dinda Putri", "M. Siska", "Mega Wati", 
                "Fitri N.", "Putri Kirana", "Bunga Citra", "Vina Larasati", "Ibu Wati",
                "Diah Paramita", "Ayu Sekar", "Lisa Permata", "Dewi Ratna", "Siti Aisyah",
                "Tika Sari", "Lia Andriani", "Adi Pratama", "Maya Kusuma", "Joko Susilo",
                "Fahri Wijaya", "Indah Sari", "Kevin Gunawan", "Nadya Azka", "Rizky F.",
                "Andi Susanto", "Citra Dewi", "Hadi Saputra", "Nurul Hidayah", "Gilang Ramadhan"
            ];

            const storeTestimonials = [
                "Kurasi produknya sangat cerdas, semua yang saya beli selalu berkualitas dan sesuai deskripsi. Benar-benar menghilangkan keraguan saat belanja online!",
                "Pelayanan cepat dan ramah. Saya suka karena kaelyshp hanya menjual barang yang terbukti BPOM dan original. Sangat terpercaya.",
                "Pilihan body care-nya modern dan up-to-date. Harganya juga kompetitif. Thank you kaelyshp!",
                "Pengiriman selalu aman dan tepat waktu. Kemasan produk sangat rapi. Kualitas kurasi toko ini patut diacungi jempol.",
                "Akhirnya ketemu toko yang fokus pada kualitas, bukan kuantitas. Produk yang direkomendasikan selalu yang terbaik.",
                "Saya sudah sering belanja di sini dan tidak pernah kecewa. Semua item 100% original, jaminan mutu terjamin.",
                "Desain website-nya profesional, dan kurasi produknya pun sama. Saya merekomendasikan kaelyshp kepada teman-teman saya.",
                "Sangat menghargai fokus pada produk rating tinggi (4.8 ke atas). Ini membuktikan kaelyshp peduli pada kepuasan pelanggan.",
                "Beli body care viral di sini terjamin keasliannya. Sudah tidak perlu khawatir lagi produk palsu. Top!",
                "Semua produknya terjamin BPOM, jadi saya merasa aman memakainya setiap hari."
            ];
            
            // OBSERVER
            const observerOptions = {
                root: null,
                rootMargin: '0px',
                threshold: 0.1 
            };

            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        if (entry.target.id === 'customer-counter-section' && customerCounterTarget) {
                            animateCounter(5482, customerCounterTarget); 
                        }
                    }
                });
            }, observerOptions);

            document.querySelectorAll('.animated-section').forEach(section => {
                observer.observe(section);
            });

            function animateCounter(targetValue, element) {
                const duration = 1500;
                const start = 0;
                let startTime = null;

                const step = (timestamp) => {
                    if (!startTime) startTime = timestamp;
                    const progress = timestamp - startTime;
                    const percentage = Math.min(progress / duration, 1);
                    const currentValue = Math.floor(percentage * targetValue);

                    if (element.id === 'customer-counter-target') {
                        element.textContent = currentValue.toLocaleString('id-ID') + '+';
                    }

                    if (percentage < 1) {
                        window.requestAnimationFrame(step);
                    } else {
                        if (element.id === 'customer-counter-target') {
                            element.textContent = targetValue.toLocaleString('id-ID') + '+';
                        }
                    }
                };
                if (!element.dataset.animated) {
                    window.requestAnimationFrame(step);
                    element.dataset.animated = 'true';
                }
            }
            
            // TESTIMONIAL SLIDER LOGIC
            let currentTestiSlide = 0;
            function getSlidesPerView() {
                const width = window.innerWidth;
                if (width < 640) return 1; 
                if (width < 1024) return 2; 
                return 3; 
            }
            let slidesPerView = getSlidesPerView();
            const totalTestiSlides = storeTestimonials.length;

            function moveToTestiSlide(index) {
                const slidesToShow = getSlidesPerView();
                const totalViews = Math.ceil(totalTestiSlides / slidesToShow);
                const slideIndexInView = Math.floor(index / slidesToShow);
                const offset = slideIndexInView * 100; 
                
                if (testimoniSliderTrack) testimoniSliderTrack.style.transform = `translateX(-${offset / totalViews}%)`;

                const dots = Array.from(testimoniDotsContainer.children);
                dots.forEach(dot => dot.classList.remove('bg-pink-600'));
                const activeDotIndex = Math.floor(index / slidesToShow);
                if (dots[activeDotIndex]) {
                    dots[activeDotIndex].classList.add('bg-pink-600');
                }
            }

            function initializeTestiDots() {
                if (!testimoniDotsContainer) return;
                testimoniDotsContainer.innerHTML = '';
                const slidesToShow = getSlidesPerView();
                const dotCount = Math.ceil(totalTestiSlides / slidesToShow);

                for (let i = 0; i < dotCount; i++) {
                    const dot = document.createElement('button');
                    dot.classList.add('testi-dot', 'w-3', 'h-3', 'bg-pink-300', 'rounded-full', 'mx-1', 'transition-all', 'duration-300', 'hover:bg-pink-500');
                    dot.setAttribute('data-index', i * slidesToShow);
                    dot.setAttribute('aria-label', `Testimonial View ${i + 1}`);
                    
                    dot.addEventListener('click', (e) => {
                        const newIndex = parseInt(e.target.getAttribute('data-index'));
                        currentTestiSlide = newIndex;
                        moveToTestiSlide(newIndex);
                        resetTestiInterval();
                    });
                    testimoniDotsContainer.appendChild(dot);
                }
                if (testimoniDotsContainer.children.length > 0) {
                     testimoniDotsContainer.children[0].classList.add('bg-pink-600');
                }
            }

            let testiInterval;
            function startTestiInterval() {
                if (!testimoniSliderTrack) return;
                testiInterval = setInterval(() => {
                    const slidesToShow = getSlidesPerView();
                    let nextSlide = currentTestiSlide + slidesToShow;
                    if (nextSlide >= totalTestiSlides) {
                        nextSlide = 0; 
                    }
                    currentTestiSlide = nextSlide;
                    moveToTestiSlide(currentTestiSlide);
                }, 5000); 
            }

            function resetTestiInterval() {
                clearInterval(testiInterval);
                startTestiInterval();
            }

            function renderTestimonials() {
                if (!testimoniSliderTrack) return;
                testimoniSliderTrack.innerHTML = ''; 
                slidesPerView = getSlidesPerView(); 
                const totalViews = Math.ceil(totalTestiSlides / slidesPerView);
                testimoniSliderTrack.style.width = `${100 * totalViews}%`; 
                const correctedSlideItemWidthPercentage = 100 / totalTestiSlides;

                for (let i = 0; i < totalTestiSlides; i++) {
                    const nameIndex = i % indonesianNames.length;
                    const reviewerName = indonesianNames[nameIndex]; 
                    const review = storeTestimonials[i].replace(/\*/g, ''); 

                    const slideItem = document.createElement('div');
                    slideItem.classList.add('testimonial-slide-item', 'animated-section');
                    slideItem.style.width = `${correctedSlideItemWidthPercentage}%`;

                    slideItem.innerHTML = `
                        <div class="testimonial-item" data-animate data-delay="${100 + i * 50}">
                            <div class="flex items-center mb-4">
                                <div class="w-10 h-10 rounded-full bg-pink-100 flex items-center justify-center text-pink-600 font-bold mr-3">
                                    ${reviewerName.charAt(0)}
                                </div>
                                <div>
                                    <p class="text-sm font-bold text-gray-800">${reviewerName}</p>
                                    <div class="flex text-yellow-400 text-xs">${renderStars(5)}</div>
                                </div>
                            </div>
                            <p class="text-gray-600 italic leading-relaxed text-sm">"${review}"</p>
                            <div class="mt-auto pt-3 border-t border-gray-50">
                                <span class="text-xs text-green-500 font-medium flex items-center"><i class="fas fa-check-circle mr-1"></i> Pembeli Terverifikasi</span>
                            </div>
                        </div>
                    `;
                    testimoniSliderTrack.appendChild(slideItem);
                    observer.observe(slideItem);
                }

                initializeTestiDots();
                startTestiInterval();
                moveToTestiSlide(currentTestiSlide); 
            }
            
            // ABOUT SLIDER LOGIC
            const aboutSliderTrack = document.getElementById('about-slider-track');
            const aboutDotsContainer = document.getElementById('about-dots');
            const aboutSlides = Array.from(aboutSliderTrack.children);
            const totalAboutSlides = aboutSlides.length;

            function getAboutSlidesPerView() {
                const width = window.innerWidth;
                if (width < 768) return 1; 
                if (width < 1024) return 2; 
                return 3; 
            }
            let aboutSlidesPerView = getAboutSlidesPerView();

            function moveToAboutSlide(index) {
                const slidesToShow = getAboutSlidesPerView();
                const totalViews = Math.ceil(totalAboutSlides / slidesToShow); 
                
                const viewPercentage = 100 / totalViews; 
                const offset = index * viewPercentage;
                
                if (aboutSliderTrack) aboutSliderTrack.style.transform = `translateX(-${offset}%)`;

                const dots = Array.from(aboutDotsContainer.children);
                dots.forEach(dot => dot.classList.remove('bg-pink-600'));
                if (dots[index]) {
                    dots[index].classList.add('bg-pink-600');
                }
            }

            function initializeAboutDots() {
                if (!aboutDotsContainer) return;
                aboutDotsContainer.innerHTML = '';
                const slidesToShow = getAboutSlidesPerView();
                const dotCount = Math.ceil(totalAboutSlides / slidesToShow);

                for (let i = 0; i < dotCount; i++) {
                    const dot = document.createElement('button');
                    dot.classList.add('about-dot', 'w-3', 'h-3', 'bg-pink-300', 'rounded-full', 'mx-1', 'transition-all', 'duration-300', 'hover:bg-pink-500');
                    dot.setAttribute('data-index', i);
                    dot.setAttribute('aria-label', `About Feature View ${i + 1}`);

                    dot.addEventListener('click', (e) => {
                        const newIndex = parseInt(e.target.getAttribute('data-index'));
                        currentAboutSlide = newIndex;
                        moveToAboutSlide(newIndex);
                    });
                    aboutDotsContainer.appendChild(dot);
                }
                if (aboutDotsContainer.children.length > 0) {
                     aboutDotsContainer.children[0].classList.add('bg-pink-600');
                }
            }
            
            function resizeAboutSlider() {
                aboutSlidesPerView = getAboutSlidesPerView();
                const totalViews = Math.ceil(totalAboutSlides / aboutSlidesPerView);
                if (aboutSliderTrack) aboutSliderTrack.style.width = `${100 * totalViews}%`;
                
                const slideItemWidthPercentage = 100 / totalAboutSlides;
                aboutSlides.forEach(slide => {
                    slide.style.width = `${slideItemWidthPercentage}%`;
                });
                
                initializeAboutDots();
                moveToAboutSlide(currentAboutSlide); 
            }
            
            let currentAboutSlide = 0; 
            resizeAboutSlider(); 

            window.addEventListener('resize', () => {
                const newSlidesPerViewTesti = getSlidesPerView();
                if (newSlidesPerViewTesti !== slidesPerView) {
                    slidesPerView = newSlidesPerViewTesti;
                    currentTestiSlide = 0; 
                    renderTestimonials(); 
                }
                resizeAboutSlider();
            });

            // RENDER REVIEWS
            function renderReviews(reviewsArray) {
                let reviewsHTML = '';
                const reviewsToDisplay = reviewsArray.slice(0, 3); 
                
                reviewsToDisplay.forEach((review, index) => {
                    const randomIndex = Math.floor(Math.random() * indonesianNames.length);
                    const reviewerName = indonesianNames[randomIndex]; 
                    
                    reviewsHTML += `
                        <div class="modern-review-card flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 rounded-full bg-pink-100 flex items-center justify-center text-pink-600 font-bold border border-pink-200">
                                ${reviewerName.charAt(0)}
                            </div>
                            <div class="flex-grow">
                                <div class="flex items-center justify-between mb-1">
                                    <span class="font-bold text-gray-800 text-sm">${reviewerName}</span>
                                    <span class="text-xs text-gray-400">2 hari lalu</span>
                                </div>
                                <div class="flex text-yellow-400 mb-2">
                                    ${renderStars(5)} 
                                </div>
                                <p class="text-sm text-gray-600 leading-relaxed">"${review.replace(/\*/g, '')}"</p>
                            </div>
                        </div>
                    `;
                });
                return reviewsHTML;
            }

            // RENDER SPECS
            function renderSpecs(specsString) {
                const cleanedString = specsString.replace(/\*/g, '').replace(/-/g, '');
                const specsArray = cleanedString.split('\n');
                let specsHTML = '';
                
                specsArray.forEach(line => {
                    if (line.trim() !== '') {
                        const parts = line.split(':');
                        if (parts.length > 1) {
                            const label = parts[0].trim();
                            const value = parts.slice(1).join(':').trim(); 
                            specsHTML += `<li><span class="font-semibold text-gray-800">${label}</span>: ${value}</li>`;
                        } else {
                            specsHTML += `<li>${line.trim()}</li>`;
                        }
                    }
                });
                return specsHTML;
            }

            // RENDER PRODUCTS
            function renderProducts(category) {
                if (!productGrid) return;
                productGrid.innerHTML = '';
                
                const productsToRender = category === 'all' 
                    ? masterProductList 
                    : masterProductList.filter(p => p.category === category);

                productsToRender.forEach(p => {
                    if (p.id === 7) p.imageUrl = 'moik.webp';
                    if (p.id === 15) p.imageUrl = 'dropku2.webp';
                    if (p.id === 16) p.imageUrl = 'cicilly.webp';
                    if (p.id === 17) p.imageUrl = 'dropku1.webp';
                });
                
                if (productsToRender.length === 0) {
                    productGrid.innerHTML = `<p class="text-gray-600 col-span-2 md:col-span-4 text-center p-8 bg-pink-100 rounded-xl">Produk untuk kategori ini akan segera hadir! Kami sedang mengkurasi yang terbaik.</p>`;
                    return;
                }

                productsToRender.forEach(product => {
                    const card = document.createElement('div');
                    card.className = `group product-card overflow-hidden animated-section`;
                    
                    let categoryLabel = product.category.charAt(0).toUpperCase() + product.category.slice(1);
                    if (product.category === 'bodylotion') categoryLabel = 'Body Care';
                    if (product.category === 'skincare') categoryLabel = 'Skincare'; 

                    card.innerHTML = `
                        <div class="w-full aspect-[4/5] overflow-hidden rounded-t-2xl relative">
                            <span class="absolute top-3 right-3 bg-white/90 backdrop-blur-sm text-pink-600 text-xs font-bold px-2 py-1 rounded shadow-sm z-10">Original ‚úîÔ∏è</span>
                            <img src="${product.imageUrl}" alt="Foto produk ${product.name}" 
                                    width="400" height="500"
                                    onerror="this.onerror=null;this.src='https://placehold.co/600x600/eeeeee/999999?text=Gagal+Muat';"
                                    class="w-full h-full object-cover product-card-image-wrapper" 
                                    loading="lazy" decoding="async"> 
                        </div>
                        <div class="p-5 flex flex-col flex-grow">
                            <div>
                                <span class="text-xs font-medium text-pink-600 bg-pink-50 px-2 py-1 rounded-full border border-pink-100">${categoryLabel}</span>
                                <h3 class="text-base md:text-lg font-bold text-gray-800 mt-2 line-clamp-2 leading-snug" title="${product.name}">${product.name.replace(/\*/g, '')}</h3>
                                
                                <div class="flex items-center mt-2 mb-3">
                                    <div class="flex text-yellow-400 text-xs mr-1">${renderStars(product.rating)}</div>
                                    <span class="text-xs text-gray-400">(${product.reviewCount.toLocaleString('id-ID')})</span>
                                </div>
                            </div>
                            
                            <div class="flex items-center justify-between mt-auto">
                                <p class="text-lg font-extrabold text-pink-600">${product.price}</p>
                                <button class="w-8 h-8 rounded-full bg-pink-50 text-pink-600 flex items-center justify-center hover:bg-pink-600 hover:text-white transition-colors">
                                    <i class="fas fa-arrow-right text-xs"></i>
                                </button>
                            </div>
                        </div>
                    `;
                    card.addEventListener('click', () => showProductModal(product));
                    productGrid.appendChild(card);
                    observer.observe(card); 
                });
            }

            // MODAL LOGIC
            function showProductModal(product) {
                if (!modal) return;
                document.getElementById('modal-img').src = product.imageUrl;
                document.getElementById('modal-img').alt = `Foto detail produk ${product.name}`;
                document.getElementById('modal-title').textContent = product.name.replace(/\*/g, '');
                document.getElementById('modal-stars').innerHTML = renderStars(product.rating);
                document.getElementById('modal-rating-text').textContent = `${product.rating} (${product.reviewCount.toLocaleString('id-ID')} ulasan)`;
                document.getElementById('modal-price').textContent = product.price;
                
                let modalCategoryLabel = product.category === 'bodylotion' ? 'Body Care' : 'Skincare'; 
                document.getElementById('modal-category').textContent = modalCategoryLabel;
                
                document.getElementById('modal-desc').textContent = product.description.replace(/\*/g, '');
                document.getElementById('modal-specs').innerHTML = renderSpecs(product.specs);
                
                document.getElementById('modal-reviews-list').innerHTML = renderReviews(product.review);
                
                document.getElementById('modal-shopee-link').href = product.shopeeUrl;
                document.getElementById('modal-shopee-link').setAttribute('aria-label', `Beli ${product.name} di Shopee`);

                modal.classList.remove('hidden');
                setTimeout(() => {
                    modal.classList.remove('opacity-0');
                    if (modalContent) modalContent.classList.remove('scale-95');
                    if (modalContent) modalContent.classList.add('scale-100');
                }, 10);
                
                document.body.style.overflow = 'hidden'; 
                if (modalCloseBtn) modalCloseBtn.focus();
            }

            function closeModal() {
                if (!modal) return;
                modal.classList.add('opacity-0');
                if (modalContent) modalContent.classList.remove('scale-100');
                if (modalContent) modalContent.classList.add('scale-95');
                
                setTimeout(() => {
                    modal.classList.add('hidden');
                    document.body.style.overflow = 'auto';
                }, 300); 
            }

            if (modalCloseBtn) modalCloseBtn.addEventListener('click', closeModal);
            if (modal) modal.addEventListener('click', (e) => {
                if (e.target === modal) closeModal();
            });

            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && modal && !modal.classList.contains('hidden')) closeModal();
            });

            // TAB LOGIC
            categoryTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const category = tab.dataset.category;
                    
                    categoryTabs.forEach(t => {
                        t.classList.remove('bg-pink-600', 'text-white', 'shadow-md', 'hover:-translate-y-1');
                        t.classList.add('bg-white', 'text-gray-600', 'hover:bg-pink-50', 'border', 'border-gray-100');
                        if (t.textContent.includes('‚úîÔ∏è')) {
                            t.textContent = t.textContent.replace('‚úîÔ∏è ', '');
                        }
                    });
                    
                    tab.classList.remove('bg-white', 'text-gray-600', 'hover:bg-pink-50', 'border', 'border-gray-100');
                    tab.classList.add('bg-pink-600', 'text-white', 'shadow-md', 'hover:-translate-y-1');
                    
                    if (!tab.textContent.includes('‚úîÔ∏è')) {
                        tab.textContent = '‚úîÔ∏è ' + tab.textContent;
                    }
                    
                    renderProducts(category);
                });
            });

            // INIT
            renderProducts('all');
            renderTestimonials(); 

            if(newsletterForm) { 
                newsletterForm.addEventListener('submit', (e) => {
                    e.preventDefault(); 
                    newsletterForm.classList.add('hidden');
                    newsletterSuccess.classList.remove('hidden');
                });
            }

            // ACCORDION
            document.querySelectorAll('.accordion-button').forEach(button => {
                button.addEventListener('click', () => {
                    const content = button.nextElementSibling;
                    const isActive = button.classList.toggle('active');
                    button.setAttribute('aria-expanded', isActive ? 'true' : 'false');
                    
                    document.querySelectorAll('.accordion-button.active').forEach(otherButton => {
                        if (otherButton !== button) {
                            otherButton.classList.remove('active');
                            otherButton.setAttribute('aria-expanded', 'false');
                            otherButton.nextElementSibling.style.maxHeight = '0';
                        }
                    });

                    if (isActive) {
                        content.style.maxHeight = content.scrollHeight + 'px';
                    } else {
                        content.style.maxHeight = '0';
                    }
                });
            });

            // MOBILE MENU
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            
            mobileMenuBtn.addEventListener('click', (e) => {
                e.stopPropagation(); 
                const isHidden = mobileMenu.classList.toggle('hidden');
                mobileMenuBtn.setAttribute('aria-expanded', !isHidden);
            });
            document.addEventListener('click', (e) => {
                if (!mobileMenu.classList.contains('hidden') && !mobileMenu.contains(e.target) && !mobileMenuBtn.contains(e.target)) {
                    mobileMenu.classList.add('hidden');
                    mobileMenuBtn.setAttribute('aria-expanded', 'false');
                }
            });
            mobileMenu.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => {
                    mobileMenu.classList.add('hidden');
                    mobileMenuBtn.setAttribute('aria-expanded', 'false');
                });
            });

            // TRUST SLIDER LOGIC
            const trustSliderTrack = document.getElementById('trust-slider-track');
            if (trustSliderTrack) { 
                const trustSlides = Array.from(trustSliderTrack.children);
                const trustDotsContainer = document.getElementById('trust-slider-dots');
                let currentTrustSlide = 0;

                trustSliderTrack.style.width = `${trustSlides.length * 100}%`;
                trustSlides.forEach(slide => {
                    slide.style.width = `${100 / trustSlides.length}%`;
                });

                trustSlides.forEach((slide, index) => {
                    const dot = document.createElement('button');
                    dot.classList.add('trust-dot', 'w-2', 'h-2', 'bg-pink-200', 'rounded-full', 'mx-1', 'transition-all', 'duration-300');
                    dot.setAttribute('aria-label', `Go to slide ${index + 1}`);
                    dot.addEventListener('click', () => {
                        moveToTrustSlide(index);
                        currentTrustSlide = index;
                        resetTrustInterval(); 
                    });
                    trustDotsContainer.appendChild(dot);
                });
                const trustDots = Array.from(trustDotsContainer.children);

                const moveToTrustSlide = (index) => {
                    trustSliderTrack.style.transform = `translateX(-${index * (100 / trustSlides.length)}%)`; 
                    trustDots.forEach(dot => dot.classList.remove('bg-pink-600'));
                    trustDots[index].classList.add('bg-pink-600');
                };

                let trustInterval = setInterval(() => {
                    currentTrustSlide++;
                    if (currentTrustSlide >= trustSlides.length) {
                        currentTrustSlide = 0;
                    }
                    moveToTrustSlide(currentTrustSlide);
                }, 3000); 

                const resetTrustInterval = () => {
                     clearInterval(trustInterval);
                     trustInterval = setInterval(() => {
                         currentTrustSlide++;
                         if (currentTrustSlide >= trustSlides.length) {
                             currentTrustSlide = 0;
                         }
                         moveToTrustSlide(currentTrustSlide);
                     }, 3000);
                };
                
                moveToTrustSlide(0);
            }
            
            // START FIREBASE
            initFirebase();
        });
    </script>

</body>
</html>
